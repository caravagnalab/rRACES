<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Sequencing Simulation • rRACES</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sequencing Simulation">
<meta name="description" content="How to simulate sample sequencing
">
<meta property="og:description" content="How to simulate sample sequencing
">
<meta property="og:image" content="https://caravagnalab.github.io/rRACES/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rRACES</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/rRACES.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/tissue_simulation.html">Tissue simulation</a></li>
    <li><a class="dropdown-item" href="../articles/sampling.html">Tissue sampling</a></li>
    <li><a class="dropdown-item" href="../articles/mutations.html">Simulating Mutations</a></li>
    <li><a class="dropdown-item" href="../articles/sequencing.html">Sequencing Simulation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/caravagnalab/rRACES/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Sequencing Simulation</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/caravagnalab/rRACES/vignettes/sequencing.Rmd" class="external-link"><code>vignettes/sequencing.Rmd</code></a></small>
      <div class="d-none name"><code>sequencing.Rmd</code></div>
    </div>

    
    
<blockquote>
<p><em>Disclaimer:</em> RACES/rRACES internally implements the
probability distributions using the C++11 random number distribution
classes. The standard does not specify their algorithms, and the class
implementations are left free for the compiler. Thus, the simulation
output depends on the compiler used to compile RACES, and because of
that, the results reported in this article may differ from those
obtained by the reader.</p>
</blockquote>
<p>Once a phylogenetic forest has been computed, as detailed in
<code><a href="../articles/mutations.html">vignette("mutations")</a></code>, rRACES can simulate the sequencing
of the samples in the forest and return the observed data.</p>
<div class="section level3">
<h3 id="sequencing-simulation">Sequencing Simulation<a class="anchor" aria-label="anchor" href="#sequencing-simulation"></a>
</h3>
<p>Let us reload the phylogenetic forest produced in
<code><a href="../articles/mutations.html">vignette("mutations")</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://caravagnalab.github.io/rRACES">rRACES</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">phylo_forest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_phylogenetic_forest.html">load_phylogenetic_forest</a></span><span class="op">(</span><span class="st">"phylo_forest.sff"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [█---------------------------------------] 0% [00m:00s] Loading forest [████------------------------------------] 8% [00m:01s] Loading forest [█████-----------------------------------] 12% [00m:02s] Loading forest [███████---------------------------------] 16% [00m:03s] Loading forest [█████████-------------------------------] 20% [00m:04s] Loading forest [██████████------------------------------] 23% [00m:05s] Loading forest [███████████-----------------------------] 27% [00m:06s] Loading forest [█████████████---------------------------] 31% [00m:07s] Loading forest [███████████████-------------------------] 35% [00m:08s] Loading forest [████████████████------------------------] 38% [00m:09s] Loading forest [█████████████████-----------------------] 41% [00m:10s] Loading forest [██████████████████----------------------] 44% [00m:12s] Loading forest [███████████████████---------------------] 47% [00m:13s] Loading forest [█████████████████████-------------------] 51% [00m:14s] Loading forest [███████████████████████-----------------] 55% [00m:15s] Loading forest [████████████████████████----------------] 58% [00m:16s] Loading forest [█████████████████████████---------------] 62% [00m:17s] Loading forest [███████████████████████████-------------] 66% [00m:18s] Loading forest [█████████████████████████████-----------] 70% [00m:19s] Loading forest [██████████████████████████████----------] 74% [00m:20s] Loading forest [████████████████████████████████--------] 78% [00m:21s] Loading forest [█████████████████████████████████-------] 82% [00m:22s] Loading forest [███████████████████████████████████-----] 86% [00m:23s] Loading forest [█████████████████████████████████████---] 90% [00m:24s] Loading forest [██████████████████████████████████████--] 94% [00m:25s] Loading forest [████████████████████████████████████████] 98% [00m:26s] Loading forest [████████████████████████████████████████] 100% [00m:27s] Forest loaded</span></span>
<span></span>
<span><span class="va">phylo_forest</span></span>
<span><span class="co">#&gt; PhylogeneticForest</span></span>
<span><span class="co">#&gt;   # of trees: 1</span></span>
<span><span class="co">#&gt;   # of nodes: 18845</span></span>
<span><span class="co">#&gt;   # of leaves: 5396</span></span>
<span><span class="co">#&gt;   samples: {"S_1_1", "S_1_2", "S_2_1", "S_2_2"}</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   # of emerged SNVs and indels: 113353</span></span>
<span><span class="co">#&gt;   # of emerged CNAs: 39</span></span></code></pre></div>
<p>The loaded phylogenetic forest models the cell evolution of 4
different samples: <code>S_1_1</code>, <code>S_1_2</code>,
<code>S_2_1</code>, and <code>S_2_2</code>.</p>
<p>We can simulate the sequencing of these samples with coverage of 2.5X
by as it follows.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># let us simulate a 50x sequencing of the four sample</span></span>
<span><span class="va">seq_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_seq.html">simulate_seq</a></span><span class="op">(</span><span class="va">phylo_forest</span>, coverage <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [█---------------------------------------] 0% [00m:00s] Found 22 [█---------------------------------------] 0% [00m:00s] Reading 22 [█---------------------------------------] 0% [00m:00s] Reading 22 [█---------------------------------------] 0% [00m:02s] Reading 22 [█---------------------------------------] 0% [00m:02s] Processing chr. 22 [█---------------------------------------] 0% [00m:08s] Processing chr. 22 [█---------------------------------------] 0% [00m:09s] Processing chr. 22 [█---------------------------------------] 0% [00m:10s] Processing chr. 22 [█---------------------------------------] 1% [00m:11s] Processing chr. 22 [█---------------------------------------] 1% [00m:12s] Processing chr. 22 [█---------------------------------------] 1% [00m:13s] Processing chr. 22 [█---------------------------------------] 2% [00m:14s] Processing chr. 22 [█---------------------------------------] 2% [00m:15s] Processing chr. 22 [█---------------------------------------] 2% [00m:16s] Processing chr. 22 [██--------------------------------------] 3% [00m:17s] Processing chr. 22 [██--------------------------------------] 3% [00m:18s] Processing chr. 22 [██--------------------------------------] 3% [00m:19s] Processing chr. 22 [██--------------------------------------] 4% [00m:20s] Processing chr. 22 [██--------------------------------------] 4% [00m:21s] Processing chr. 22 [██--------------------------------------] 4% [00m:22s] Processing chr. 22 [███-------------------------------------] 5% [00m:23s] Processing chr. 22 [███-------------------------------------] 5% [00m:24s] Processing chr. 22 [███-------------------------------------] 5% [00m:25s] Processing chr. 22 [███-------------------------------------] 6% [00m:26s] Processing chr. 22 [███-------------------------------------] 6% [00m:27s] Processing chr. 22 [███-------------------------------------] 6% [00m:28s] Processing chr. 22 [███-------------------------------------] 7% [00m:29s] Processing chr. 22 [███-------------------------------------] 7% [00m:30s] Processing chr. 22 [███-------------------------------------] 7% [00m:31s] Processing chr. 22 [████------------------------------------] 8% [00m:32s] Processing chr. 22 [████------------------------------------] 8% [00m:33s] Processing chr. 22 [████------------------------------------] 8% [00m:34s] Processing chr. 22 [████------------------------------------] 9% [00m:35s] Processing chr. 22 [████------------------------------------] 9% [00m:36s] Processing chr. 22 [█████-----------------------------------] 10% [00m:37s] Processing chr. 22 [█████-----------------------------------] 10% [00m:38s] Processing chr. 22 [█████-----------------------------------] 10% [00m:39s] Processing chr. 22 [█████-----------------------------------] 11% [00m:40s] Processing chr. 22 [█████-----------------------------------] 11% [00m:41s] Processing chr. 22 [█████-----------------------------------] 11% [00m:42s] Processing chr. 22 [█████-----------------------------------] 12% [00m:43s] Processing chr. 22 [█████-----------------------------------] 12% [00m:44s] Processing chr. 22 [█████-----------------------------------] 12% [00m:45s] Processing chr. 22 [██████----------------------------------] 13% [00m:46s] Processing chr. 22 [██████----------------------------------] 13% [00m:47s] Processing chr. 22 [██████----------------------------------] 13% [00m:48s] Processing chr. 22 [██████----------------------------------] 14% [00m:49s] Processing chr. 22 [██████----------------------------------] 14% [00m:50s] Processing chr. 22 [██████----------------------------------] 14% [00m:51s] Processing chr. 22 [███████---------------------------------] 15% [00m:52s] Processing chr. 22 [███████---------------------------------] 15% [00m:53s] Processing chr. 22 [███████---------------------------------] 15% [00m:54s] Processing chr. 22 [███████---------------------------------] 16% [00m:55s] Processing chr. 22 [███████---------------------------------] 16% [00m:56s] Processing chr. 22 [███████---------------------------------] 17% [00m:57s] Processing chr. 22 [███████---------------------------------] 17% [00m:58s] Processing chr. 22 [███████---------------------------------] 17% [00m:59s] Processing chr. 22 [████████--------------------------------] 18% [01m:00s] Processing chr. 22 [████████--------------------------------] 18% [01m:01s] Processing chr. 22 [████████--------------------------------] 18% [01m:02s] Processing chr. 22 [████████--------------------------------] 19% [01m:03s] Processing chr. 22 [████████--------------------------------] 19% [01m:04s] Processing chr. 22 [████████--------------------------------] 19% [01m:05s] Processing chr. 22 [█████████-------------------------------] 20% [01m:06s] Processing chr. 22 [█████████-------------------------------] 20% [01m:07s] Processing chr. 22 [█████████-------------------------------] 20% [01m:08s] Processing chr. 22 [█████████-------------------------------] 21% [01m:09s] Processing chr. 22 [█████████-------------------------------] 21% [01m:10s] Processing chr. 22 [█████████-------------------------------] 21% [01m:11s] Processing chr. 22 [█████████-------------------------------] 22% [01m:12s] Processing chr. 22 [█████████-------------------------------] 22% [01m:13s] Processing chr. 22 [█████████-------------------------------] 22% [01m:14s] Processing chr. 22 [██████████------------------------------] 23% [01m:15s] Processing chr. 22 [██████████------------------------------] 23% [01m:16s] Processing chr. 22 [██████████------------------------------] 23% [01m:17s] Processing chr. 22 [██████████------------------------------] 23% [01m:18s] Processing chr. 22 [██████████------------------------------] 23% [01m:19s] Processing chr. 22 [██████████------------------------------] 24% [01m:20s] Processing chr. 22 [██████████------------------------------] 24% [01m:21s] Processing chr. 22 [██████████------------------------------] 24% [01m:22s] Processing chr. 22 [███████████-----------------------------] 25% [01m:23s] Processing chr. 22 [███████████-----------------------------] 25% [01m:24s] Processing chr. 22 [███████████-----------------------------] 25% [01m:25s] Processing chr. 22 [███████████-----------------------------] 26% [01m:26s] Processing chr. 22 [███████████-----------------------------] 26% [01m:27s] Processing chr. 22 [███████████-----------------------------] 26% [01m:28s] Processing chr. 22 [███████████-----------------------------] 27% [01m:29s] Processing chr. 22 [███████████-----------------------------] 27% [01m:30s] Processing chr. 22 [███████████-----------------------------] 27% [01m:31s] Processing chr. 22 [████████████----------------------------] 28% [01m:32s] Processing chr. 22 [████████████----------------------------] 28% [01m:33s] Processing chr. 22 [████████████----------------------------] 28% [01m:34s] Processing chr. 22 [████████████----------------------------] 29% [01m:35s] Processing chr. 22 [████████████----------------------------] 29% [01m:36s] Processing chr. 22 [████████████----------------------------] 29% [01m:37s] Processing chr. 22 [█████████████---------------------------] 30% [01m:38s] Processing chr. 22 [█████████████---------------------------] 30% [01m:39s] Processing chr. 22 [█████████████---------------------------] 30% [01m:40s] Processing chr. 22 [█████████████---------------------------] 31% [01m:41s] Processing chr. 22 [█████████████---------------------------] 31% [01m:42s] Processing chr. 22 [█████████████---------------------------] 31% [01m:43s] Processing chr. 22 [█████████████---------------------------] 32% [01m:44s] Processing chr. 22 [█████████████---------------------------] 32% [01m:45s] Processing chr. 22 [██████████████--------------------------] 33% [01m:46s] Processing chr. 22 [██████████████--------------------------] 33% [01m:47s] Processing chr. 22 [██████████████--------------------------] 33% [01m:48s] Processing chr. 22 [██████████████--------------------------] 34% [01m:49s] Processing chr. 22 [██████████████--------------------------] 34% [01m:50s] Processing chr. 22 [██████████████--------------------------] 34% [01m:51s] Processing chr. 22 [███████████████-------------------------] 35% [01m:52s] Processing chr. 22 [███████████████-------------------------] 35% [01m:53s] Processing chr. 22 [███████████████-------------------------] 35% [01m:54s] Processing chr. 22 [███████████████-------------------------] 36% [01m:55s] Processing chr. 22 [███████████████-------------------------] 36% [01m:56s] Processing chr. 22 [███████████████-------------------------] 36% [01m:57s] Processing chr. 22 [███████████████-------------------------] 37% [01m:58s] Processing chr. 22 [███████████████-------------------------] 37% [01m:59s] Processing chr. 22 [███████████████-------------------------] 37% [02m:00s] Processing chr. 22 [████████████████------------------------] 38% [02m:01s] Processing chr. 22 [████████████████------------------------] 38% [02m:02s] Processing chr. 22 [████████████████------------------------] 38% [02m:03s] Processing chr. 22 [████████████████------------------------] 39% [02m:04s] Processing chr. 22 [████████████████------------------------] 39% [02m:05s] Processing chr. 22 [█████████████████-----------------------] 40% [02m:06s] Processing chr. 22 [█████████████████-----------------------] 40% [02m:07s] Processing chr. 22 [█████████████████-----------------------] 40% [02m:08s] Processing chr. 22 [█████████████████-----------------------] 41% [02m:09s] Processing chr. 22 [█████████████████-----------------------] 41% [02m:10s] Processing chr. 22 [█████████████████-----------------------] 41% [02m:11s] Processing chr. 22 [█████████████████-----------------------] 42% [02m:12s] Processing chr. 22 [█████████████████-----------------------] 42% [02m:13s] Processing chr. 22 [█████████████████-----------------------] 42% [02m:14s] Processing chr. 22 [██████████████████----------------------] 43% [02m:15s] Processing chr. 22 [██████████████████----------------------] 43% [02m:16s] Processing chr. 22 [██████████████████----------------------] 43% [02m:17s] Processing chr. 22 [██████████████████----------------------] 44% [02m:18s] Processing chr. 22 [██████████████████----------------------] 44% [02m:19s] Processing chr. 22 [██████████████████----------------------] 44% [02m:20s] Processing chr. 22 [███████████████████---------------------] 45% [02m:21s] Processing chr. 22 [███████████████████---------------------] 45% [02m:22s] Processing chr. 22 [███████████████████---------------------] 46% [02m:23s] Processing chr. 22 [███████████████████---------------------] 46% [02m:24s] Processing chr. 22 [███████████████████---------------------] 46% [02m:25s] Processing chr. 22 [███████████████████---------------------] 47% [02m:26s] Processing chr. 22 [███████████████████---------------------] 47% [02m:27s] Processing chr. 22 [███████████████████---------------------] 47% [02m:28s] Processing chr. 22 [████████████████████--------------------] 48% [02m:29s] Processing chr. 22 [████████████████████--------------------] 48% [02m:30s] Processing chr. 22 [████████████████████--------------------] 48% [02m:31s] Processing chr. 22 [████████████████████--------------------] 48% [02m:32s] Processing chr. 22 [████████████████████--------------------] 48% [02m:33s] Processing chr. 22 [████████████████████--------------------] 49% [02m:34s] Processing chr. 22 [████████████████████--------------------] 49% [02m:35s] Processing chr. 22 [████████████████████--------------------] 49% [02m:36s] Processing chr. 22 [████████████████████--------------------] 49% [02m:37s] Processing chr. 22 [█████████████████████-------------------] 50% [02m:38s] Processing chr. 22 [█████████████████████-------------------] 50% [02m:39s] Processing chr. 22 [█████████████████████-------------------] 50% [02m:40s] Processing chr. 22 [█████████████████████-------------------] 50% [02m:41s] Processing chr. 22 [█████████████████████-------------------] 50% [02m:42s] Processing chr. 22 [█████████████████████-------------------] 51% [02m:43s] Processing chr. 22 [█████████████████████-------------------] 51% [02m:44s] Processing chr. 22 [█████████████████████-------------------] 51% [02m:45s] Processing chr. 22 [█████████████████████-------------------] 51% [02m:46s] Processing chr. 22 [█████████████████████-------------------] 51% [02m:47s] Processing chr. 22 [█████████████████████-------------------] 52% [02m:48s] Processing chr. 22 [█████████████████████-------------------] 52% [02m:49s] Processing chr. 22 [█████████████████████-------------------] 52% [02m:50s] Processing chr. 22 [█████████████████████-------------------] 52% [02m:51s] Processing chr. 22 [██████████████████████------------------] 52% [02m:52s] Processing chr. 22 [██████████████████████------------------] 52% [02m:53s] Processing chr. 22 [██████████████████████------------------] 52% [02m:54s] Processing chr. 22 [██████████████████████------------------] 52% [02m:55s] Processing chr. 22 [██████████████████████------------------] 52% [02m:56s] Processing chr. 22 [██████████████████████------------------] 54% [02m:57s] Processing chr. 22 [██████████████████████------------------] 54% [02m:58s] Processing chr. 22 [██████████████████████------------------] 54% [02m:59s] Processing chr. 22 [██████████████████████------------------] 54% [03m:00s] Processing chr. 22 [██████████████████████------------------] 54% [03m:01s] Processing chr. 22 [███████████████████████-----------------] 55% [03m:02s] Processing chr. 22 [███████████████████████-----------------] 55% [03m:03s] Processing chr. 22 [███████████████████████-----------------] 55% [03m:04s] Processing chr. 22 [███████████████████████-----------------] 55% [03m:05s] Processing chr. 22 [███████████████████████-----------------] 56% [03m:06s] Processing chr. 22 [███████████████████████-----------------] 56% [03m:07s] Processing chr. 22 [███████████████████████-----------------] 56% [03m:08s] Processing chr. 22 [███████████████████████-----------------] 56% [03m:09s] Processing chr. 22 [███████████████████████-----------------] 56% [03m:10s] Processing chr. 22 [███████████████████████-----------------] 57% [03m:11s] Processing chr. 22 [███████████████████████-----------------] 57% [03m:12s] Processing chr. 22 [███████████████████████-----------------] 57% [03m:13s] Processing chr. 22 [███████████████████████-----------------] 57% [03m:14s] Processing chr. 22 [████████████████████████----------------] 58% [03m:15s] Processing chr. 22 [████████████████████████----------------] 58% [03m:16s] Processing chr. 22 [████████████████████████----------------] 58% [03m:17s] Processing chr. 22 [████████████████████████----------------] 58% [03m:18s] Processing chr. 22 [████████████████████████----------------] 58% [03m:19s] Processing chr. 22 [████████████████████████----------------] 58% [03m:20s] Processing chr. 22 [████████████████████████----------------] 58% [03m:21s] Processing chr. 22 [████████████████████████----------------] 58% [03m:22s] Processing chr. 22 [████████████████████████----------------] 58% [03m:23s] Processing chr. 22 [█████████████████████████---------------] 60% [03m:24s] Processing chr. 22 [█████████████████████████---------------] 60% [03m:25s] Processing chr. 22 [█████████████████████████---------------] 60% [03m:26s] Processing chr. 22 [█████████████████████████---------------] 60% [03m:27s] Processing chr. 22 [█████████████████████████---------------] 60% [03m:28s] Processing chr. 22 [█████████████████████████---------------] 61% [03m:29s] Processing chr. 22 [█████████████████████████---------------] 61% [03m:30s] Processing chr. 22 [█████████████████████████---------------] 61% [03m:31s] Processing chr. 22 [█████████████████████████---------------] 61% [03m:32s] Processing chr. 22 [█████████████████████████---------------] 62% [03m:33s] Processing chr. 22 [█████████████████████████---------------] 62% [03m:34s] Processing chr. 22 [█████████████████████████---------------] 62% [03m:35s] Processing chr. 22 [█████████████████████████---------------] 62% [03m:36s] Processing chr. 22 [█████████████████████████---------------] 62% [03m:37s] Processing chr. 22 [██████████████████████████--------------] 63% [03m:38s] Processing chr. 22 [██████████████████████████--------------] 63% [03m:39s] Processing chr. 22 [██████████████████████████--------------] 63% [03m:40s] Processing chr. 22 [██████████████████████████--------------] 63% [03m:41s] Processing chr. 22 [██████████████████████████--------------] 63% [03m:42s] Processing chr. 22 [██████████████████████████--------------] 64% [03m:43s] Processing chr. 22 [██████████████████████████--------------] 64% [03m:44s] Processing chr. 22 [██████████████████████████--------------] 64% [03m:45s] Processing chr. 22 [██████████████████████████--------------] 64% [03m:46s] Processing chr. 22 [███████████████████████████-------------] 65% [03m:47s] Processing chr. 22 [███████████████████████████-------------] 65% [03m:48s] Processing chr. 22 [███████████████████████████-------------] 65% [04m:13s] Processing chr. 22 [███████████████████████████-------------] 65% [04m:14s] Processing chr. 22 [███████████████████████████-------------] 65% [04m:15s] Processing chr. 22 [███████████████████████████-------------] 65% [04m:16s] Processing chr. 22 [███████████████████████████-------------] 65% [04m:17s] Processing chr. 22 [███████████████████████████-------------] 66% [04m:18s] Processing chr. 22 [███████████████████████████-------------] 66% [04m:19s] Processing chr. 22 [███████████████████████████-------------] 66% [04m:20s] Processing chr. 22 [███████████████████████████-------------] 66% [04m:21s] Processing chr. 22 [███████████████████████████-------------] 67% [04m:22s] Processing chr. 22 [███████████████████████████-------------] 67% [04m:23s] Processing chr. 22 [███████████████████████████-------------] 67% [04m:24s] Processing chr. 22 [███████████████████████████-------------] 67% [04m:25s] Processing chr. 22 [███████████████████████████-------------] 67% [04m:26s] Processing chr. 22 [████████████████████████████------------] 68% [04m:27s] Processing chr. 22 [████████████████████████████------------] 68% [04m:28s] Processing chr. 22 [████████████████████████████------------] 68% [04m:29s] Processing chr. 22 [████████████████████████████------------] 68% [04m:30s] Processing chr. 22 [████████████████████████████------------] 69% [04m:31s] Processing chr. 22 [████████████████████████████------------] 69% [04m:32s] Processing chr. 22 [████████████████████████████------------] 69% [04m:33s] Processing chr. 22 [████████████████████████████------------] 69% [04m:34s] Processing chr. 22 [████████████████████████████------------] 69% [04m:35s] Processing chr. 22 [█████████████████████████████-----------] 70% [04m:36s] Processing chr. 22 [█████████████████████████████-----------] 70% [04m:37s] Processing chr. 22 [█████████████████████████████-----------] 70% [04m:38s] Processing chr. 22 [█████████████████████████████-----------] 70% [04m:39s] Processing chr. 22 [█████████████████████████████-----------] 70% [04m:40s] Processing chr. 22 [█████████████████████████████-----------] 71% [04m:41s] Processing chr. 22 [█████████████████████████████-----------] 71% [04m:42s] Processing chr. 22 [█████████████████████████████-----------] 71% [04m:43s] Processing chr. 22 [█████████████████████████████-----------] 71% [04m:44s] Processing chr. 22 [█████████████████████████████-----------] 72% [04m:45s] Processing chr. 22 [█████████████████████████████-----------] 72% [04m:46s] Processing chr. 22 [█████████████████████████████-----------] 72% [04m:47s] Processing chr. 22 [█████████████████████████████-----------] 72% [04m:48s] Processing chr. 22 [█████████████████████████████-----------] 72% [04m:49s] Processing chr. 22 [██████████████████████████████----------] 73% [04m:50s] Processing chr. 22 [██████████████████████████████----------] 73% [04m:51s] Processing chr. 22 [██████████████████████████████----------] 73% [04m:52s] Processing chr. 22 [██████████████████████████████----------] 73% [04m:53s] Processing chr. 22 [██████████████████████████████----------] 74% [04m:54s] Processing chr. 22 [██████████████████████████████----------] 74% [04m:55s] Processing chr. 22 [██████████████████████████████----------] 74% [04m:56s] Processing chr. 22 [██████████████████████████████----------] 74% [04m:57s] Processing chr. 22 [██████████████████████████████----------] 74% [04m:58s] Processing chr. 22 [███████████████████████████████---------] 75% [04m:59s] Processing chr. 22 [███████████████████████████████---------] 75% [05m:00s] Processing chr. 22 [███████████████████████████████---------] 75% [05m:01s] Processing chr. 22 [███████████████████████████████---------] 75% [05m:02s] Processing chr. 22 [███████████████████████████████---------] 76% [05m:03s] Processing chr. 22 [███████████████████████████████---------] 76% [05m:04s] Processing chr. 22 [███████████████████████████████---------] 76% [05m:05s] Processing chr. 22 [███████████████████████████████---------] 76% [05m:06s] Processing chr. 22 [███████████████████████████████---------] 76% [05m:07s] Processing chr. 22 [███████████████████████████████---------] 77% [05m:08s] Processing chr. 22 [███████████████████████████████---------] 77% [05m:09s] Processing chr. 22 [███████████████████████████████---------] 77% [05m:10s] Processing chr. 22 [███████████████████████████████---------] 77% [05m:11s] Processing chr. 22 [████████████████████████████████--------] 78% [05m:12s] Processing chr. 22 [████████████████████████████████--------] 78% [05m:14s] Processing chr. 22 [████████████████████████████████--------] 78% [05m:15s] Processing chr. 22 [████████████████████████████████--------] 78% [05m:16s] Processing chr. 22 [████████████████████████████████--------] 78% [05m:17s] Processing chr. 22 [████████████████████████████████--------] 78% [05m:18s] Processing chr. 22 [████████████████████████████████--------] 78% [05m:19s] Processing chr. 22 [████████████████████████████████--------] 78% [05m:20s] Processing chr. 22 [████████████████████████████████--------] 78% [05m:21s] Processing chr. 22 [████████████████████████████████--------] 78% [05m:22s] Processing chr. 22 [████████████████████████████████--------] 78% [05m:23s] Processing chr. 22 [████████████████████████████████--------] 78% [05m:24s] Processing chr. 22 [████████████████████████████████--------] 79% [05m:25s] Processing chr. 22 [████████████████████████████████--------] 79% [05m:26s] Processing chr. 22 [████████████████████████████████--------] 79% [05m:27s] Processing chr. 22 [████████████████████████████████--------] 79% [05m:28s] Processing chr. 22 [████████████████████████████████--------] 79% [05m:29s] Processing chr. 22 [████████████████████████████████--------] 79% [05m:30s] Processing chr. 22 [████████████████████████████████--------] 79% [05m:31s] Processing chr. 22 [████████████████████████████████--------] 79% [05m:32s] Processing chr. 22 [████████████████████████████████--------] 79% [05m:33s] Processing chr. 22 [████████████████████████████████--------] 79% [05m:34s] Processing chr. 22 [████████████████████████████████--------] 79% [05m:35s] Processing chr. 22 [████████████████████████████████--------] 79% [05m:36s] Processing chr. 22 [████████████████████████████████--------] 79% [05m:37s] Processing chr. 22 [█████████████████████████████████-------] 80% [05m:38s] Processing chr. 22 [█████████████████████████████████-------] 80% [05m:39s] Processing chr. 22 [█████████████████████████████████-------] 80% [05m:40s] Processing chr. 22 [█████████████████████████████████-------] 80% [05m:41s] Processing chr. 22 [█████████████████████████████████-------] 80% [05m:42s] Processing chr. 22 [█████████████████████████████████-------] 80% [05m:43s] Processing chr. 22 [█████████████████████████████████-------] 80% [05m:44s] Processing chr. 22 [█████████████████████████████████-------] 80% [05m:45s] Processing chr. 22 [█████████████████████████████████-------] 80% [05m:46s] Processing chr. 22 [█████████████████████████████████-------] 80% [05m:47s] Processing chr. 22 [█████████████████████████████████-------] 80% [05m:48s] Processing chr. 22 [█████████████████████████████████-------] 80% [05m:49s] Processing chr. 22 [█████████████████████████████████-------] 80% [05m:50s] Processing chr. 22 [█████████████████████████████████-------] 81% [05m:51s] Processing chr. 22 [█████████████████████████████████-------] 81% [05m:52s] Processing chr. 22 [█████████████████████████████████-------] 81% [05m:53s] Processing chr. 22 [█████████████████████████████████-------] 81% [05m:54s] Processing chr. 22 [█████████████████████████████████-------] 81% [05m:55s] Processing chr. 22 [█████████████████████████████████-------] 81% [05m:56s] Processing chr. 22 [█████████████████████████████████-------] 81% [05m:57s] Processing chr. 22 [█████████████████████████████████-------] 81% [05m:58s] Processing chr. 22 [█████████████████████████████████-------] 81% [05m:59s] Processing chr. 22 [█████████████████████████████████-------] 81% [06m:00s] Processing chr. 22 [█████████████████████████████████-------] 81% [06m:01s] Processing chr. 22 [█████████████████████████████████-------] 81% [06m:02s] Processing chr. 22 [█████████████████████████████████-------] 81% [06m:03s] Processing chr. 22 [█████████████████████████████████-------] 82% [06m:04s] Processing chr. 22 [█████████████████████████████████-------] 82% [06m:05s] Processing chr. 22 [█████████████████████████████████-------] 82% [06m:06s] Processing chr. 22 [█████████████████████████████████-------] 82% [06m:07s] Processing chr. 22 [█████████████████████████████████-------] 82% [06m:08s] Processing chr. 22 [█████████████████████████████████-------] 82% [06m:09s] Processing chr. 22 [█████████████████████████████████-------] 82% [06m:10s] Processing chr. 22 [█████████████████████████████████-------] 82% [06m:11s] Processing chr. 22 [█████████████████████████████████-------] 82% [06m:12s] Processing chr. 22 [█████████████████████████████████-------] 82% [06m:13s] Processing chr. 22 [█████████████████████████████████-------] 82% [06m:14s] Processing chr. 22 [█████████████████████████████████-------] 82% [06m:15s] Processing chr. 22 [█████████████████████████████████-------] 82% [06m:16s] Processing chr. 22 [██████████████████████████████████------] 83% [06m:17s] Processing chr. 22 [██████████████████████████████████------] 83% [06m:18s] Processing chr. 22 [██████████████████████████████████------] 83% [06m:19s] Processing chr. 22 [██████████████████████████████████------] 83% [06m:20s] Processing chr. 22 [██████████████████████████████████------] 83% [06m:21s] Processing chr. 22 [██████████████████████████████████------] 83% [06m:22s] Processing chr. 22 [██████████████████████████████████------] 83% [06m:23s] Processing chr. 22 [██████████████████████████████████------] 83% [06m:24s] Processing chr. 22 [██████████████████████████████████------] 83% [06m:25s] Processing chr. 22 [██████████████████████████████████------] 83% [06m:26s] Processing chr. 22 [██████████████████████████████████------] 83% [06m:27s] Processing chr. 22 [██████████████████████████████████------] 83% [06m:28s] Processing chr. 22 [██████████████████████████████████------] 83% [06m:29s] Processing chr. 22 [██████████████████████████████████------] 84% [06m:30s] Processing chr. 22 [██████████████████████████████████------] 84% [06m:31s] Processing chr. 22 [██████████████████████████████████------] 84% [11m:12s] Processing chr. 22 [██████████████████████████████████------] 84% [11m:13s] Processing chr. 22 [██████████████████████████████████------] 84% [11m:14s] Processing chr. 22 [██████████████████████████████████------] 84% [11m:15s] Processing chr. 22 [██████████████████████████████████------] 84% [11m:16s] Processing chr. 22 [██████████████████████████████████------] 84% [11m:17s] Processing chr. 22 [██████████████████████████████████------] 84% [11m:18s] Processing chr. 22 [██████████████████████████████████------] 84% [11m:19s] Processing chr. 22 [██████████████████████████████████------] 84% [11m:20s] Processing chr. 22 [██████████████████████████████████------] 84% [11m:21s] Processing chr. 22 [██████████████████████████████████------] 84% [11m:22s] Processing chr. 22 [██████████████████████████████████------] 84% [11m:23s] Processing chr. 22 [███████████████████████████████████-----] 85% [11m:24s] Processing chr. 22 [███████████████████████████████████-----] 85% [11m:25s] Processing chr. 22 [███████████████████████████████████-----] 85% [11m:26s] Processing chr. 22 [███████████████████████████████████-----] 85% [11m:27s] Processing chr. 22 [███████████████████████████████████-----] 85% [11m:28s] Processing chr. 22 [███████████████████████████████████-----] 85% [11m:29s] Processing chr. 22 [███████████████████████████████████-----] 85% [11m:30s] Processing chr. 22 [███████████████████████████████████-----] 85% [11m:31s] Processing chr. 22 [███████████████████████████████████-----] 85% [11m:32s] Processing chr. 22 [███████████████████████████████████-----] 85% [11m:33s] Processing chr. 22 [███████████████████████████████████-----] 85% [11m:34s] Processing chr. 22 [███████████████████████████████████-----] 85% [11m:35s] Processing chr. 22 [███████████████████████████████████-----] 85% [11m:36s] Processing chr. 22 [███████████████████████████████████-----] 86% [11m:37s] Processing chr. 22 [███████████████████████████████████-----] 86% [11m:38s] Processing chr. 22 [███████████████████████████████████-----] 86% [11m:39s] Processing chr. 22 [███████████████████████████████████-----] 86% [11m:40s] Processing chr. 22 [███████████████████████████████████-----] 86% [11m:41s] Processing chr. 22 [███████████████████████████████████-----] 86% [11m:42s] Processing chr. 22 [███████████████████████████████████-----] 86% [11m:43s] Processing chr. 22 [███████████████████████████████████-----] 86% [11m:44s] Processing chr. 22 [███████████████████████████████████-----] 86% [11m:45s] Processing chr. 22 [███████████████████████████████████-----] 86% [11m:46s] Processing chr. 22 [███████████████████████████████████-----] 86% [11m:47s] Processing chr. 22 [███████████████████████████████████-----] 86% [11m:48s] Processing chr. 22 [███████████████████████████████████-----] 86% [11m:49s] Processing chr. 22 [███████████████████████████████████-----] 87% [11m:50s] Processing chr. 22 [███████████████████████████████████-----] 87% [11m:51s] Processing chr. 22 [███████████████████████████████████-----] 87% [11m:52s] Processing chr. 22 [███████████████████████████████████-----] 87% [11m:53s] Processing chr. 22 [███████████████████████████████████-----] 87% [11m:54s] Processing chr. 22 [███████████████████████████████████-----] 87% [11m:55s] Processing chr. 22 [███████████████████████████████████-----] 87% [11m:56s] Processing chr. 22 [███████████████████████████████████-----] 87% [11m:57s] Processing chr. 22 [███████████████████████████████████-----] 87% [11m:58s] Processing chr. 22 [███████████████████████████████████-----] 87% [11m:59s] Processing chr. 22 [███████████████████████████████████-----] 87% [12m:00s] Processing chr. 22 [███████████████████████████████████-----] 87% [12m:01s] Processing chr. 22 [███████████████████████████████████-----] 87% [12m:02s] Processing chr. 22 [████████████████████████████████████----] 88% [12m:03s] Processing chr. 22 [████████████████████████████████████----] 88% [12m:04s] Processing chr. 22 [████████████████████████████████████----] 88% [12m:05s] Processing chr. 22 [████████████████████████████████████----] 88% [12m:06s] Processing chr. 22 [████████████████████████████████████----] 88% [12m:07s] Processing chr. 22 [████████████████████████████████████----] 88% [12m:08s] Processing chr. 22 [████████████████████████████████████----] 88% [12m:09s] Processing chr. 22 [████████████████████████████████████----] 88% [12m:10s] Processing chr. 22 [████████████████████████████████████----] 88% [12m:11s] Processing chr. 22 [████████████████████████████████████----] 88% [12m:12s] Processing chr. 22 [████████████████████████████████████----] 88% [12m:13s] Processing chr. 22 [████████████████████████████████████----] 88% [12m:14s] Processing chr. 22 [████████████████████████████████████----] 88% [12m:15s] Processing chr. 22 [████████████████████████████████████----] 89% [12m:16s] Processing chr. 22 [████████████████████████████████████----] 89% [12m:17s] Processing chr. 22 [████████████████████████████████████----] 89% [12m:18s] Processing chr. 22 [████████████████████████████████████----] 89% [12m:19s] Processing chr. 22 [████████████████████████████████████----] 89% [12m:20s] Processing chr. 22 [████████████████████████████████████----] 89% [12m:21s] Processing chr. 22 [████████████████████████████████████----] 89% [12m:22s] Processing chr. 22 [████████████████████████████████████----] 89% [12m:23s] Processing chr. 22 [████████████████████████████████████----] 89% [12m:24s] Processing chr. 22 [████████████████████████████████████----] 89% [12m:25s] Processing chr. 22 [████████████████████████████████████----] 89% [12m:26s] Processing chr. 22 [████████████████████████████████████----] 89% [12m:27s] Processing chr. 22 [█████████████████████████████████████---] 90% [12m:28s] Processing chr. 22 [█████████████████████████████████████---] 90% [12m:29s] Processing chr. 22 [█████████████████████████████████████---] 90% [12m:30s] Processing chr. 22 [█████████████████████████████████████---] 90% [12m:31s] Processing chr. 22 [█████████████████████████████████████---] 90% [12m:32s] Processing chr. 22 [█████████████████████████████████████---] 90% [12m:33s] Processing chr. 22 [█████████████████████████████████████---] 90% [12m:34s] Processing chr. 22 [█████████████████████████████████████---] 90% [12m:35s] Processing chr. 22 [█████████████████████████████████████---] 90% [12m:36s] Processing chr. 22 [█████████████████████████████████████---] 90% [12m:37s] Processing chr. 22 [█████████████████████████████████████---] 90% [12m:38s] Processing chr. 22 [█████████████████████████████████████---] 90% [12m:39s] Processing chr. 22 [█████████████████████████████████████---] 91% [12m:40s] Processing chr. 22 [█████████████████████████████████████---] 91% [12m:41s] Processing chr. 22 [█████████████████████████████████████---] 91% [12m:42s] Processing chr. 22 [█████████████████████████████████████---] 91% [12m:43s] Processing chr. 22 [█████████████████████████████████████---] 91% [12m:44s] Processing chr. 22 [█████████████████████████████████████---] 91% [12m:45s] Processing chr. 22 [█████████████████████████████████████---] 91% [12m:46s] Processing chr. 22 [█████████████████████████████████████---] 91% [12m:47s] Processing chr. 22 [█████████████████████████████████████---] 91% [12m:48s] Processing chr. 22 [█████████████████████████████████████---] 91% [12m:49s] Processing chr. 22 [█████████████████████████████████████---] 91% [12m:50s] Processing chr. 22 [█████████████████████████████████████---] 91% [12m:51s] Processing chr. 22 [█████████████████████████████████████---] 91% [12m:52s] Processing chr. 22 [█████████████████████████████████████---] 92% [12m:53s] Processing chr. 22 [█████████████████████████████████████---] 92% [12m:54s] Processing chr. 22 [█████████████████████████████████████---] 92% [12m:55s] Processing chr. 22 [█████████████████████████████████████---] 92% [12m:56s] Processing chr. 22 [█████████████████████████████████████---] 92% [12m:57s] Processing chr. 22 [█████████████████████████████████████---] 92% [12m:58s] Processing chr. 22 [█████████████████████████████████████---] 92% [12m:59s] Processing chr. 22 [█████████████████████████████████████---] 92% [13m:00s] Processing chr. 22 [█████████████████████████████████████---] 92% [13m:01s] Processing chr. 22 [█████████████████████████████████████---] 92% [13m:02s] Processing chr. 22 [█████████████████████████████████████---] 92% [13m:03s] Processing chr. 22 [█████████████████████████████████████---] 92% [13m:04s] Processing chr. 22 [██████████████████████████████████████--] 93% [13m:05s] Processing chr. 22 [██████████████████████████████████████--] 93% [13m:06s] Processing chr. 22 [██████████████████████████████████████--] 93% [13m:07s] Processing chr. 22 [██████████████████████████████████████--] 93% [13m:08s] Processing chr. 22 [██████████████████████████████████████--] 93% [13m:09s] Processing chr. 22 [██████████████████████████████████████--] 93% [13m:10s] Processing chr. 22 [██████████████████████████████████████--] 93% [13m:11s] Processing chr. 22 [██████████████████████████████████████--] 93% [13m:12s] Processing chr. 22 [██████████████████████████████████████--] 93% [13m:13s] Processing chr. 22 [██████████████████████████████████████--] 93% [13m:14s] Processing chr. 22 [██████████████████████████████████████--] 93% [13m:15s] Processing chr. 22 [██████████████████████████████████████--] 93% [13m:16s] Processing chr. 22 [██████████████████████████████████████--] 93% [13m:17s] Processing chr. 22 [██████████████████████████████████████--] 94% [13m:18s] Processing chr. 22 [██████████████████████████████████████--] 94% [13m:19s] Processing chr. 22 [██████████████████████████████████████--] 94% [13m:20s] Processing chr. 22 [██████████████████████████████████████--] 94% [13m:21s] Processing chr. 22 [██████████████████████████████████████--] 94% [13m:22s] Processing chr. 22 [██████████████████████████████████████--] 94% [13m:23s] Processing chr. 22 [██████████████████████████████████████--] 94% [13m:24s] Processing chr. 22 [██████████████████████████████████████--] 94% [13m:25s] Processing chr. 22 [██████████████████████████████████████--] 94% [13m:26s] Processing chr. 22 [██████████████████████████████████████--] 94% [13m:27s] Processing chr. 22 [██████████████████████████████████████--] 94% [13m:28s] Processing chr. 22 [██████████████████████████████████████--] 94% [13m:29s] Processing chr. 22 [███████████████████████████████████████-] 95% [29m:11s] Processing chr. 22 [███████████████████████████████████████-] 95% [29m:12s] Processing chr. 22 [███████████████████████████████████████-] 95% [29m:13s] Processing chr. 22 [███████████████████████████████████████-] 95% [29m:14s] Processing chr. 22 [███████████████████████████████████████-] 95% [29m:15s] Processing chr. 22 [███████████████████████████████████████-] 95% [29m:16s] Processing chr. 22 [███████████████████████████████████████-] 95% [29m:17s] Processing chr. 22 [███████████████████████████████████████-] 95% [29m:18s] Processing chr. 22 [███████████████████████████████████████-] 95% [29m:19s] Processing chr. 22 [███████████████████████████████████████-] 95% [29m:20s] Processing chr. 22 [███████████████████████████████████████-] 95% [29m:21s] Processing chr. 22 [███████████████████████████████████████-] 95% [29m:22s] Processing chr. 22 [███████████████████████████████████████-] 95% [29m:23s] Processing chr. 22 [███████████████████████████████████████-] 96% [29m:24s] Processing chr. 22 [███████████████████████████████████████-] 96% [29m:25s] Processing chr. 22 [███████████████████████████████████████-] 96% [29m:26s] Processing chr. 22 [███████████████████████████████████████-] 96% [29m:27s] Processing chr. 22 [███████████████████████████████████████-] 96% [29m:28s] Processing chr. 22 [███████████████████████████████████████-] 96% [29m:29s] Processing chr. 22 [███████████████████████████████████████-] 96% [29m:30s] Processing chr. 22 [███████████████████████████████████████-] 96% [29m:31s] Processing chr. 22 [███████████████████████████████████████-] 96% [29m:32s] Processing chr. 22 [███████████████████████████████████████-] 96% [29m:33s] Processing chr. 22 [███████████████████████████████████████-] 96% [29m:34s] Processing chr. 22 [███████████████████████████████████████-] 96% [29m:35s] Processing chr. 22 [███████████████████████████████████████-] 97% [29m:36s] Processing chr. 22 [███████████████████████████████████████-] 97% [29m:37s] Processing chr. 22 [███████████████████████████████████████-] 97% [29m:38s] Processing chr. 22 [███████████████████████████████████████-] 97% [29m:39s] Processing chr. 22 [███████████████████████████████████████-] 97% [29m:40s] Processing chr. 22 [███████████████████████████████████████-] 97% [29m:41s] Processing chr. 22 [███████████████████████████████████████-] 97% [29m:42s] Processing chr. 22 [███████████████████████████████████████-] 97% [29m:43s] Processing chr. 22 [███████████████████████████████████████-] 97% [29m:44s] Processing chr. 22 [███████████████████████████████████████-] 97% [29m:45s] Processing chr. 22 [███████████████████████████████████████-] 97% [29m:46s] Processing chr. 22 [███████████████████████████████████████-] 97% [29m:47s] Processing chr. 22 [███████████████████████████████████████-] 97% [29m:48s] Processing chr. 22 [████████████████████████████████████████] 98% [29m:49s] Processing chr. 22 [████████████████████████████████████████] 98% [29m:50s] Processing chr. 22 [████████████████████████████████████████] 98% [29m:51s] Processing chr. 22 [████████████████████████████████████████] 98% [29m:52s] Processing chr. 22 [████████████████████████████████████████] 98% [29m:53s] Processing chr. 22 [████████████████████████████████████████] 98% [29m:54s] Processing chr. 22 [████████████████████████████████████████] 98% [29m:55s] Processing chr. 22 [████████████████████████████████████████] 98% [29m:56s] Processing chr. 22 [████████████████████████████████████████] 98% [29m:57s] Processing chr. 22 [████████████████████████████████████████] 98% [29m:58s] Processing chr. 22 [████████████████████████████████████████] 98% [29m:59s] Processing chr. 22 [████████████████████████████████████████] 98% [30m:00s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:01s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:02s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:03s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:04s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:05s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:06s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:07s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:08s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:09s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:10s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:11s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:12s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:13s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:14s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:15s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:16s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:17s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:18s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:19s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:20s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:21s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:22s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:23s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:24s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:25s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:26s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:27s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:28s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:29s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:30s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:31s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:32s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:33s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:34s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:35s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:36s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:37s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:38s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:39s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:40s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:41s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:42s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:43s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:44s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:45s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:46s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:47s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:48s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:49s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:50s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:51s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:52s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:53s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:54s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:55s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:56s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:57s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:58s] Processing chr. 22 [████████████████████████████████████████] 99% [30m:59s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:00s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:01s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:02s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:03s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:04s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:05s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:06s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:07s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:08s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:09s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:10s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:11s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:12s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:13s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:14s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:15s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:16s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:17s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:18s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:19s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:20s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:21s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:22s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:23s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:24s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:25s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:26s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:27s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:28s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:29s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:30s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:31s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:32s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:33s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:34s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:35s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:36s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:37s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:38s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:39s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:40s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:41s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:42s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:43s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:44s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:45s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:46s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:47s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:48s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:49s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:50s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:51s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:52s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:53s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:54s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:55s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:56s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:57s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:58s] Processing chr. 22 [████████████████████████████████████████] 99% [31m:59s] Processing chr. 22 [████████████████████████████████████████] 99% [32m:00s] Processing chr. 22 [████████████████████████████████████████] 99% [32m:01s] Processing chr. 22 [████████████████████████████████████████] 99% [32m:02s] Processing chr. 22 [████████████████████████████████████████] 99% [32m:03s] Processing chr. 22 [████████████████████████████████████████] 99% [32m:04s] Processing chr. 22 [████████████████████████████████████████] 99% [32m:05s] Processing chr. 22 [████████████████████████████████████████] 99% [32m:06s] Processing chr. 22 [████████████████████████████████████████] 99% [32m:07s] Processing chr. 22 [████████████████████████████████████████] 99% [32m:08s] Processing chr. 22 [████████████████████████████████████████] 99% [32m:09s] Processing chr. 22 [████████████████████████████████████████] 99% [32m:10s] Processing chr. 22 [████████████████████████████████████████] 99% [32m:11s] Processing chr. 22 [████████████████████████████████████████] 99% [32m:12s] Processing chr. 22 [████████████████████████████████████████] 99% [32m:13s] Processing chr. 22 [████████████████████████████████████████] 99% [48m:35s] Processing chr. 22 [████████████████████████████████████████] 99% [48m:36s] Processing chr. 22 [████████████████████████████████████████] 99% [48m:37s] Processing chr. 22 [████████████████████████████████████████] 99% [48m:38s] Processing chr. 22 [████████████████████████████████████████] 99% [48m:39s] Processing chr. 22 [████████████████████████████████████████] 99% [48m:40s] Processing chr. 22 [████████████████████████████████████████] 99% [01h:15m:37s] Processing chr. 22 [████████████████████████████████████████] 99% [01h:15m:38s] Processing chr. 22 [████████████████████████████████████████] 99% [01h:15m:39s] Processing chr. 22 [████████████████████████████████████████] 99% [01h:15m:40s] Processing chr. 22 [████████████████████████████████████████] 99% [01h:15m:41s] Processing chr. 22 [████████████████████████████████████████] 99% [01h:15m:42s] Processing chr. 22 [████████████████████████████████████████] 99% [01h:15m:43s] Processing chr. 22 [████████████████████████████████████████] 99% [01h:15m:44s] Processing chr. 22 [████████████████████████████████████████] 99% [01h:15m:45s] Processing chr. 22 [████████████████████████████████████████] 99% [01h:15m:46s] Processing chr. 22 [████████████████████████████████████████] 99% [01h:15m:47s] Processing chr. 22 [████████████████████████████████████████] 99% [01h:15m:48s] Processing chr. 22 [████████████████████████████████████████] 99% [01h:15m:49s] Processing chr. 22 [████████████████████████████████████████] 100% [01h:15m:54s] Reads simulated</span></span>
<span></span>
<span><span class="co"># let us load the dplyr library to filter the `simulate_seq` output</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span></span>
<span><span class="va">seq_results</span><span class="op">$</span><span class="va">parameters</span></span>
<span><span class="co">#&gt; $sequencer</span></span>
<span><span class="co">#&gt; list()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $reference_genome</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $chromosomes</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $coverage</span></span>
<span><span class="co">#&gt; [1] 30</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $read_size</span></span>
<span><span class="co">#&gt; [1] 150</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $insert_size_mean</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $insert_size_stddev</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $output_dir</span></span>
<span><span class="co">#&gt; [1] "rRACES_SAM"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $write_SAM</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $update_SAM</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cell_labelling</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $purity</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $with_normal_sample</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $filename_prefix</span></span>
<span><span class="co">#&gt; [1] "chr_"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $template_name_prefix</span></span>
<span><span class="co">#&gt; [1] "r"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $include_non_sequenced_mutations</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $seed</span></span>
<span><span class="co">#&gt; [1] -1800664448</span></span>
<span></span>
<span><span class="va">seq_results</span><span class="op">$</span><span class="va">mutations</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">head</span></span>
<span><span class="co">#&gt;   chr  chr_pos ref   alt causes  classes S_1_1.occurrences S_1_1.coverage</span></span>
<span><span class="co">#&gt; 1  22 16051493   G     A        germinal                17             25</span></span>
<span><span class="co">#&gt; 2  22 16052080   G     A        germinal                17             33</span></span>
<span><span class="co">#&gt; 3  22 16052167   A AAAAC        germinal                37             37</span></span>
<span><span class="co">#&gt; 4  22 16053659   A     C        germinal                28             28</span></span>
<span><span class="co">#&gt; 5  22 16053863   G     A        germinal                22             41</span></span>
<span><span class="co">#&gt; 6  22 16054740   A     G        germinal                31             31</span></span>
<span><span class="co">#&gt;   S_1_1.VAF S_1_2.occurrences S_1_2.coverage S_1_2.VAF S_2_1.occurrences</span></span>
<span><span class="co">#&gt; 1 0.6800000                17             32 0.5312500                12</span></span>
<span><span class="co">#&gt; 2 0.5151515                22             37 0.5945946                19</span></span>
<span><span class="co">#&gt; 3 1.0000000                33             33 1.0000000                35</span></span>
<span><span class="co">#&gt; 4 1.0000000                30             30 1.0000000                35</span></span>
<span><span class="co">#&gt; 5 0.5365854                15             33 0.4545455                14</span></span>
<span><span class="co">#&gt; 6 1.0000000                24             24 1.0000000                36</span></span>
<span><span class="co">#&gt;   S_2_1.coverage S_2_1.VAF S_2_2.occurrences S_2_2.coverage S_2_2.VAF</span></span>
<span><span class="co">#&gt; 1             30 0.4000000                21             36 0.5833333</span></span>
<span><span class="co">#&gt; 2             40 0.4750000                13             27 0.4814815</span></span>
<span><span class="co">#&gt; 3             35 1.0000000                24             24 1.0000000</span></span>
<span><span class="co">#&gt; 4             35 1.0000000                31             31 1.0000000</span></span>
<span><span class="co">#&gt; 5             41 0.3414634                17             32 0.5312500</span></span>
<span><span class="co">#&gt; 6             36 1.0000000                31             31 1.0000000</span></span>
<span><span class="co">#&gt;   normal_sample.occurrences normal_sample.coverage normal_sample.VAF</span></span>
<span><span class="co">#&gt; 1                        14                     32         0.4375000</span></span>
<span><span class="co">#&gt; 2                         6                     23         0.2608696</span></span>
<span><span class="co">#&gt; 3                        24                     24         1.0000000</span></span>
<span><span class="co">#&gt; 4                        24                     24         1.0000000</span></span>
<span><span class="co">#&gt; 5                        15                     33         0.4545455</span></span>
<span><span class="co">#&gt; 6                        28                     28         1.0000000</span></span></code></pre></div>
<p>The function <code><a href="../reference/simulate_seq.html">simulate_seq()</a></code> returns named list of two
elements: a data frame whose rows represent the mutations observed in
the simulated reads (name “<code>mutations</code>”) and the calling
parameters (name “<code>parameters</code>”).</p>
<p>The number of columns in the data frame “<code>mutations</code>”
depends on the number of samples in the phylogenetic forest. The first
four columns describe the mutation and report the chromosome and the
position in the chromosome of the mutation (columns <code>chr</code> and
<code>chr_pos</code>, respectively), the genetic context in which the
mutation occurs (column <code>context</code>), and the new base (column
<code>alt_base</code>). Then, there are three columns for each of the
samples: they contain the number of simulated reads affected by the
mutation, the sequencing coverage of the mutation locus, and the ratio
between these two last columns (columns
<code>&lt;sample name&gt; occurrences</code>,
<code>&lt;sample name&gt; coverage</code>, and
<code>&lt;sample name&gt; VAF</code>, respectively).</p>
</div>
<div class="section level3">
<h3 id="plotting-sequencing-data">Plotting Sequencing Data<a class="anchor" aria-label="anchor" href="#plotting-sequencing-data"></a>
</h3>
<p>rRACES/RACE provides functions to plot the Variant Allele Frequency
(VAF), the B-Allele Frequency (BAF), and the Depth Ratio (DR) of a
sample.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># filter germinal mutations</span></span>
<span><span class="va">f_seq</span> <span class="op">&lt;-</span> <span class="va">seq_results</span><span class="op">$</span><span class="va">mutations</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">classes</span> <span class="op">!=</span> <span class="st">"germinal"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the VAF of the mutations sequenced on the sample S_2_2</span></span>
<span><span class="co"># over the reference genome</span></span>
<span><span class="fu"><a href="../reference/plot_VAF.html">plot_VAF</a></span><span class="op">(</span><span class="va">f_seq</span>, sample <span class="op">=</span> <span class="st">"S_2_2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sequencing_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># plot the BAF of the mutations sequenced on the sample S_2_2</span></span>
<span><span class="co"># over the reference genome</span></span>
<span><span class="fu"><a href="../reference/plot_BAF.html">plot_BAF</a></span><span class="op">(</span><span class="va">f_seq</span>, sample <span class="op">=</span> <span class="st">"S_2_2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sequencing_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># plot the DR of the mutations sequenced on the sample S_2_2</span></span>
<span><span class="co"># over the reference genome</span></span>
<span><span class="fu"><a href="../reference/plot_DR.html">plot_DR</a></span><span class="op">(</span><span class="va">f_seq</span>, sample <span class="op">=</span> <span class="st">"S_2_2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sequencing_files/figure-html/unnamed-chunk-5-3.png" width="700"></p>
<p>The VAF and the VAF marginal distributions can be plot too.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plotting the VAF histogram</span></span>
<span><span class="fu"><a href="../reference/plot_VAF_histogram.html">plot_VAF_histogram</a></span><span class="op">(</span><span class="va">f_seq</span>, cuts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="sequencing_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># plotting the VAF marginals</span></span>
<span><span class="fu"><a href="../reference/plot_VAF_marginals.html">plot_VAF_marginals</a></span><span class="op">(</span><span class="va">f_seq</span>, samples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S_1_1"</span>, <span class="st">"S_1_2"</span>, <span class="st">"S_2_2"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span></code></pre></div>
<p><img src="sequencing_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span></code></pre>
<p><img src="sequencing_files/figure-html/unnamed-chunk-6-3.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span></code></pre>
<p><img src="sequencing_files/figure-html/unnamed-chunk-6-4.png" width="700"></p>
<p>The VAF and the VAF marginal plots can be labelled.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plotting the VAF histogram with labels</span></span>
<span><span class="fu"><a href="../reference/plot_VAF_histogram.html">plot_VAF_histogram</a></span><span class="op">(</span><span class="va">f_seq</span>, labels <span class="op">=</span> <span class="va">f_seq</span><span class="op">[</span><span class="st">"classes"</span><span class="op">]</span>, cuts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="sequencing_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># plotting the VAF marginals and labelling it</span></span>
<span><span class="fu"><a href="../reference/plot_VAF_marginals.html">plot_VAF_marginals</a></span><span class="op">(</span><span class="va">f_seq</span>, samples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S_1_1"</span>, <span class="st">"S_1_2"</span>, <span class="st">"S_2_2"</span><span class="op">)</span>,</span>
<span>                   labels <span class="op">=</span> <span class="va">f_seq</span><span class="op">[</span><span class="st">"classes"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span></code></pre></div>
<p><img src="sequencing_files/figure-html/unnamed-chunk-7-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span></code></pre>
<p><img src="sequencing_files/figure-html/unnamed-chunk-7-3.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span></code></pre>
<p><img src="sequencing_files/figure-html/unnamed-chunk-7-4.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="saving-the-simulated-reads">Saving the Simulated Reads<a class="anchor" aria-label="anchor" href="#saving-the-simulated-reads"></a>
</h3>
<p>rRACES/RACE can also save the simulated reads in the SAM format (see
<span class="citation">(Li et al. 2009)</span>). By setting the optional
parameter <code>write_SAM</code> to <code>TRUE</code>, the function
<code><a href="../reference/simulate_seq.html">simulate_seq()</a></code> creates the directory
<code>rRACES_SAM</code> and saves the SAM files in it. Each file is
named after one of the reference genome chromosomes and contains the
simulated reads. The reads are split into read groups corresponding to
the collected samples.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seq_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_seq.html">simulate_seq</a></span><span class="op">(</span><span class="va">phylo_forest</span>, coverage <span class="op">=</span> <span class="fl">2.5</span>, write_SAM <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [█---------------------------------------] 0% [00m:00s] Found 22 [█---------------------------------------] 0% [00m:00s] Reading 22 [█---------------------------------------] 0% [00m:00s] Reading 22 [█---------------------------------------] 0% [00m:01s] Reading 22 [█---------------------------------------] 0% [00m:02s] Reading 22 [█---------------------------------------] 0% [00m:03s] Processing chr. 22 [█---------------------------------------] 0% [00m:09s] Processing chr. 22 [██--------------------------------------] 3% [00m:10s] Processing chr. 22 [███-------------------------------------] 6% [00m:11s] Processing chr. 22 [████------------------------------------] 9% [00m:12s] Processing chr. 22 [█████-----------------------------------] 12% [00m:13s] Processing chr. 22 [███████---------------------------------] 15% [00m:14s] Processing chr. 22 [████████--------------------------------] 18% [00m:15s] Processing chr. 22 [█████████-------------------------------] 21% [00m:16s] Processing chr. 22 [██████████------------------------------] 24% [00m:17s] Processing chr. 22 [███████████-----------------------------] 27% [00m:18s] Processing chr. 22 [█████████████---------------------------] 30% [00m:19s] Processing chr. 22 [██████████████--------------------------] 33% [00m:20s] Processing chr. 22 [███████████████-------------------------] 36% [00m:21s] Processing chr. 22 [████████████████------------------------] 39% [00m:22s] Processing chr. 22 [█████████████████-----------------------] 42% [00m:23s] Processing chr. 22 [███████████████████---------------------] 45% [00m:24s] Processing chr. 22 [████████████████████--------------------] 48% [00m:25s] Processing chr. 22 [████████████████████--------------------] 49% [00m:26s] Processing chr. 22 [█████████████████████-------------------] 51% [00m:27s] Processing chr. 22 [██████████████████████------------------] 52% [00m:28s] Processing chr. 22 [███████████████████████-----------------] 55% [00m:29s] Processing chr. 22 [███████████████████████-----------------] 57% [00m:30s] Processing chr. 22 [████████████████████████----------------] 58% [00m:31s] Processing chr. 22 [█████████████████████████---------------] 61% [00m:32s] Processing chr. 22 [██████████████████████████--------------] 63% [00m:33s] Processing chr. 22 [██████████████████████████--------------] 64% [00m:34s] Processing chr. 22 [███████████████████████████-------------] 66% [00m:35s] Processing chr. 22 [████████████████████████████------------] 68% [00m:36s] Processing chr. 22 [█████████████████████████████-----------] 70% [00m:37s] Processing chr. 22 [█████████████████████████████-----------] 72% [00m:38s] Processing chr. 22 [██████████████████████████████----------] 74% [00m:39s] Processing chr. 22 [███████████████████████████████---------] 76% [00m:40s] Processing chr. 22 [████████████████████████████████--------] 78% [00m:41s] Processing chr. 22 [████████████████████████████████--------] 78% [00m:42s] Processing chr. 22 [████████████████████████████████--------] 79% [00m:43s] Processing chr. 22 [████████████████████████████████--------] 79% [00m:44s] Processing chr. 22 [█████████████████████████████████-------] 80% [00m:45s] Processing chr. 22 [█████████████████████████████████-------] 81% [00m:46s] Processing chr. 22 [█████████████████████████████████-------] 81% [00m:47s] Processing chr. 22 [█████████████████████████████████-------] 82% [00m:48s] Processing chr. 22 [██████████████████████████████████------] 83% [00m:49s] Processing chr. 22 [██████████████████████████████████------] 83% [00m:50s] Processing chr. 22 [██████████████████████████████████------] 84% [00m:51s] Processing chr. 22 [███████████████████████████████████-----] 85% [00m:52s] Processing chr. 22 [███████████████████████████████████-----] 85% [00m:53s] Processing chr. 22 [███████████████████████████████████-----] 86% [00m:54s] Processing chr. 22 [███████████████████████████████████-----] 87% [00m:55s] Processing chr. 22 [███████████████████████████████████-----] 87% [00m:56s] Processing chr. 22 [████████████████████████████████████----] 88% [00m:57s] Processing chr. 22 [████████████████████████████████████----] 88% [00m:58s] Processing chr. 22 [████████████████████████████████████----] 89% [00m:59s] Processing chr. 22 [█████████████████████████████████████---] 90% [01m:00s] Processing chr. 22 [█████████████████████████████████████---] 90% [01m:01s] Processing chr. 22 [█████████████████████████████████████---] 91% [01m:02s] Processing chr. 22 [█████████████████████████████████████---] 91% [01m:03s] Processing chr. 22 [█████████████████████████████████████---] 92% [01m:04s] Processing chr. 22 [██████████████████████████████████████--] 93% [01m:05s] Processing chr. 22 [██████████████████████████████████████--] 94% [01m:06s] Processing chr. 22 [██████████████████████████████████████--] 94% [01m:07s] Processing chr. 22 [███████████████████████████████████████-] 95% [01m:08s] Processing chr. 22 [███████████████████████████████████████-] 96% [01m:09s] Processing chr. 22 [███████████████████████████████████████-] 96% [01m:10s] Processing chr. 22 [███████████████████████████████████████-] 97% [01m:11s] Processing chr. 22 [████████████████████████████████████████] 98% [01m:12s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:13s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:14s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:15s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:16s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:17s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:18s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:19s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:20s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:21s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:22s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:23s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:24s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:25s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:26s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:27s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:28s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:29s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:30s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:31s] Processing chr. 22 [████████████████████████████████████████] 100% [01m:36s] Reads simulated</span></span>
<span></span>
<span><span class="va">sam_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">"rRACES_SAM/"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ex_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"rRACES_SAM/"</span>, <span class="va">sam_files</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">line</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="va">ex_file</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">line</span>, <span class="st">"\n"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; @HD  VN:1.6  SO:unknown </span></span>
<span><span class="co">#&gt; @SQ  SN:22   LN:51304566 AN:chr22, chromosome22,chromosome_22,chr_22 </span></span>
<span><span class="co">#&gt; @RG  ID:S_1_1    SM:S_1_1    PL:ILLUMINA </span></span>
<span><span class="co">#&gt; @RG  ID:S_1_2    SM:S_1_2    PL:ILLUMINA </span></span>
<span><span class="co">#&gt; @RG  ID:S_2_1    SM:S_2_1    PL:ILLUMINA </span></span>
<span><span class="co">#&gt; @RG  ID:S_2_2    SM:S_2_2    PL:ILLUMINA </span></span>
<span><span class="co">#&gt; @RG  ID:normal_sample    SM:normal_sample    PL:ILLUMINA </span></span>
<span><span class="co">#&gt; r2200000000000   0   22  24829765    93  150M    *   0   0   CCCGGAGCCAGGGTGAGCCTGGGATCAGGGCCTGGTCTGCAGTGTCAGCATGGTGAGCTGGCGACGGGGCCCCAGGCTCAGCAGGGGCTCCCCAGGGCCAGCACGTGGCCAGCAGTCATGCCGAACTGACTGACCCCTATGGGCGCAGGG  FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF  RG:Z:S_1_1  NM:i:0 </span></span>
<span><span class="co">#&gt; r2200000000001   16  22  26095059    93  150M    *   0   0   GCGGGCAGGAGGTGGGACTGTGTGCAGGAGCCCTCACTGCCTCAGCTGTGAACAAGGGGATAATGCCACCTGTTCTACTTCCTCACAAAGTTGCATGTGGGAGAACCTCAAAAATATGCCTGTCAGCCTCCTGTGCATTTTTCCTGTGTT  FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF  RG:Z:S_1_1  NM:i:0 </span></span>
<span><span class="co">#&gt; r2200000000002   16  22  27649479    93  150M    *   0   0   TCTTATGCTTCTTGGATATCATCGGAGGGAAAACGGGGACTATGCAACAACAAAGAATGCAAGAAACACCCAGGGGAGCAGGGGTGGGGGCTTTCAATCGCCTGGAATCAATGCACAGTATTCCTGACTCTCGCTGGAATACTGTGGGTC  FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF  RG:Z:S_1_1  NM:i:0</span></span></code></pre></div>
<p>Each SAM file contains the reads produced by simulating the
sequencing of <em>all</em> the samples. The command-line tools <a href="http://www.htslib.org" class="external-link"><code>samtools</code></a> can be used to
split the reads by sample.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">foo@bar</span> % samtools split  <span class="at">-f</span> <span class="st">"%*_%\!.sam"</span> rRACES_SAM/chr_22.sam</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="ex">foo@bar</span> % ls chr_22_<span class="pp">*</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="ex">chr_22_S_1_1.sam</span>        chr_22_S_1_2.sam        chr_22_S_2_1.sam        chr_22_S_2_2.sam</span></code></pre></div>
<p>The resulting files are named after the samples, each containing the
reads of only one sample.</p>
<p>Please refer to the <a href="http://www.htslib.org/doc/samtools-split.html" class="external-link"><code>samtools split</code>
manual</a> for more details.</p>
<p>The <code><a href="../reference/simulate_seq.html">simulate_seq()</a></code> parameter <code>output_dir</code> set
the SAM output directory. See the following section for usage examples
of this parameter.</p>
</div>
<div class="section level3">
<h3 id="sample-purity">Sample Purity<a class="anchor" aria-label="anchor" href="#sample-purity"></a>
</h3>
<p>The <em>sample purity</em> represents the concentration of tumour
cells in a sample. More formally, it is the ratio between the number of
tumour cells in the sample and that of all the sample cells, either
tumour or normal (i.e., cells having germline and pre-neoplastic
mutations).</p>
<p>rRACES can simulate different sample purity in sequencing
simulations.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># simulate the sequencing of a sample in which 70% of the cells are</span></span>
<span><span class="co"># tumour cells</span></span>
<span><span class="va">seq_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_seq.html">simulate_seq</a></span><span class="op">(</span><span class="va">phylo_forest</span>, coverage <span class="op">=</span> <span class="fl">2.5</span>, purity <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>                            write_SAM <span class="op">=</span> <span class="cn">TRUE</span>, output_dir <span class="op">=</span> <span class="st">"SAM_0.7"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [█---------------------------------------] 0% [00m:00s] Found 22 [█---------------------------------------] 0% [00m:00s] Reading 22 [█---------------------------------------] 0% [00m:00s] Reading 22 [█---------------------------------------] 0% [00m:01s] Reading 22 [█---------------------------------------] 0% [00m:02s] Processing chr. 22 [█---------------------------------------] 0% [00m:10s] Processing chr. 22 [█---------------------------------------] 2% [00m:11s] Processing chr. 22 [███-------------------------------------] 5% [00m:12s] Processing chr. 22 [████------------------------------------] 8% [00m:13s] Processing chr. 22 [█████-----------------------------------] 11% [00m:14s] Processing chr. 22 [██████----------------------------------] 14% [00m:15s] Processing chr. 22 [███████---------------------------------] 17% [00m:16s] Processing chr. 22 [█████████-------------------------------] 20% [00m:17s] Processing chr. 22 [██████████------------------------------] 23% [00m:18s] Processing chr. 22 [███████████-----------------------------] 26% [00m:19s] Processing chr. 22 [████████████----------------------------] 29% [00m:20s] Processing chr. 22 [█████████████---------------------------] 32% [00m:21s] Processing chr. 22 [███████████████-------------------------] 35% [00m:22s] Processing chr. 22 [████████████████------------------------] 38% [00m:23s] Processing chr. 22 [█████████████████-----------------------] 40% [00m:24s] Processing chr. 22 [██████████████████----------------------] 43% [00m:25s] Processing chr. 22 [███████████████████---------------------] 46% [00m:26s] Processing chr. 22 [████████████████████--------------------] 48% [00m:27s] Processing chr. 22 [█████████████████████-------------------] 50% [00m:28s] Processing chr. 22 [█████████████████████-------------------] 52% [00m:29s] Processing chr. 22 [██████████████████████------------------] 54% [00m:30s] Processing chr. 22 [███████████████████████-----------------] 56% [00m:31s] Processing chr. 22 [████████████████████████----------------] 58% [00m:32s] Processing chr. 22 [█████████████████████████---------------] 60% [00m:33s] Processing chr. 22 [█████████████████████████---------------] 62% [00m:34s] Processing chr. 22 [██████████████████████████--------------] 64% [00m:35s] Processing chr. 22 [███████████████████████████-------------] 66% [00m:36s] Processing chr. 22 [███████████████████████████-------------] 67% [00m:37s] Processing chr. 22 [████████████████████████████------------] 69% [00m:38s] Processing chr. 22 [█████████████████████████████-----------] 71% [00m:39s] Processing chr. 22 [██████████████████████████████----------] 73% [00m:40s] Processing chr. 22 [███████████████████████████████---------] 75% [00m:41s] Processing chr. 22 [███████████████████████████████---------] 77% [00m:42s] Processing chr. 22 [████████████████████████████████--------] 78% [00m:43s] Processing chr. 22 [████████████████████████████████--------] 78% [00m:44s] Processing chr. 22 [████████████████████████████████--------] 79% [00m:45s] Processing chr. 22 [█████████████████████████████████-------] 80% [00m:46s] Processing chr. 22 [█████████████████████████████████-------] 81% [00m:47s] Processing chr. 22 [█████████████████████████████████-------] 81% [00m:48s] Processing chr. 22 [█████████████████████████████████-------] 82% [00m:49s] Processing chr. 22 [██████████████████████████████████------] 83% [00m:50s] Processing chr. 22 [██████████████████████████████████------] 83% [00m:51s] Processing chr. 22 [██████████████████████████████████------] 84% [00m:52s] Processing chr. 22 [███████████████████████████████████-----] 85% [00m:53s] Processing chr. 22 [███████████████████████████████████-----] 85% [00m:54s] Processing chr. 22 [███████████████████████████████████-----] 86% [00m:55s] Processing chr. 22 [███████████████████████████████████-----] 87% [00m:56s] Processing chr. 22 [███████████████████████████████████-----] 87% [00m:57s] Processing chr. 22 [███████████████████████████████████-----] 87% [00m:58s] Processing chr. 22 [████████████████████████████████████----] 88% [00m:59s] Processing chr. 22 [████████████████████████████████████----] 88% [01m:00s] Processing chr. 22 [████████████████████████████████████----] 89% [01m:01s] Processing chr. 22 [█████████████████████████████████████---] 90% [01m:02s] Processing chr. 22 [█████████████████████████████████████---] 90% [01m:03s] Processing chr. 22 [█████████████████████████████████████---] 91% [01m:04s] Processing chr. 22 [█████████████████████████████████████---] 92% [01m:05s] Processing chr. 22 [██████████████████████████████████████--] 93% [01m:06s] Processing chr. 22 [██████████████████████████████████████--] 93% [01m:07s] Processing chr. 22 [██████████████████████████████████████--] 94% [01m:08s] Processing chr. 22 [███████████████████████████████████████-] 95% [01m:09s] Processing chr. 22 [███████████████████████████████████████-] 95% [01m:10s] Processing chr. 22 [███████████████████████████████████████-] 96% [01m:11s] Processing chr. 22 [███████████████████████████████████████-] 97% [01m:12s] Processing chr. 22 [████████████████████████████████████████] 98% [01m:13s] Processing chr. 22 [████████████████████████████████████████] 98% [01m:14s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:15s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:16s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:17s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:18s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:19s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:20s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:21s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:22s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:23s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:24s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:25s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:26s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:27s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:28s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:29s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:30s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:31s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:32s] Processing chr. 22 [████████████████████████████████████████] 100% [01m:36s] Reads simulated</span></span>
<span></span>
<span><span class="va">sam_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">"SAM_0.7/"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ex_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"SAM_0.7/"</span>, <span class="va">sam_files</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">line</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="va">ex_file</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">line</span>, <span class="st">"\n"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; @HD  VN:1.6  SO:unknown </span></span>
<span><span class="co">#&gt; @SQ  SN:22   LN:51304566 AN:chr22, chromosome22,chromosome_22,chr_22 </span></span>
<span><span class="co">#&gt; @RG  ID:S_1_1    SM:S_1_1    PL:ILLUMINA </span></span>
<span><span class="co">#&gt; @RG  ID:S_1_2    SM:S_1_2    PL:ILLUMINA </span></span>
<span><span class="co">#&gt; @RG  ID:S_2_1    SM:S_2_1    PL:ILLUMINA </span></span>
<span><span class="co">#&gt; @RG  ID:S_2_2    SM:S_2_2    PL:ILLUMINA </span></span>
<span><span class="co">#&gt; @RG  ID:normal_sample    SM:normal_sample    PL:ILLUMINA </span></span>
<span><span class="co">#&gt; r2200000000000   16  22  24241870    93  150M    *   0   0   ATTGACAGTAAGGATGCTGATGACTATTAGTGAATAAAAAGCCAGAATGAAGGACATGAACTTACACACATTTAACATTTCGGCACAGGTCAAGTAACTACAATAACCTATATACAAGACAAACAAGACAAAGTATATTTAGAATACATG  FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF  RG:Z:S_1_1  NM:i:0 </span></span>
<span><span class="co">#&gt; r2200000000001   0   22  35233547    93  150M    *   0   0   GGATCTCAAACATGCTTTCTTTACTATTCCTTTGCACCTTTCATCCCAGCCTCTCTTCGCTTTCACTTGGACTGACCCTGACACCCATCAGGCTCAGCAAATTACGTGGGCTGTACTGCCACAAGGCTTCACAGACAGCCCCCATTACTT  FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF  RG:Z:S_1_1  NM:i:0 </span></span>
<span><span class="co">#&gt; r2200000000002   16  22  40342397    93  150M    *   0   0   TTTACATGGGTCTCATGCATTACAAGAAGGGGGCCACTATTTTAACTCAATTCAAAAATGTTAAAATCAAAATTCCCAAAATGTACTTGGTTTATAATATATCATAAAATAAGTAATCTGACCAATTGAGCCTCCCAACTCGAAGACCAA  FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF  RG:Z:S_1_1  NM:i:0</span></span></code></pre></div>
<p>The default value of the parameter <code>purity</code> is 1, i.e.,
<code><a href="../reference/simulate_seq.html">simulate_seq()</a></code> assumes all the cells in the sample to be
neoplastic by default.</p>
<p>The function <code><a href="../reference/simulate_normal_seq.html">simulate_normal_seq()</a></code> simulates the
sequencing of a sample whose cells have germline and tumoral
pre-neoplastic mutations. The pre-neoplastic mutations can be avoided by
setting the optional parameter <code>with_preneoplastic</code>.</p>
</div>
<div class="section level3">
<h3 id="simulating-sequencing-errors">Simulating Sequencing Errors<a class="anchor" aria-label="anchor" href="#simulating-sequencing-errors"></a>
</h3>
<p>To simulate sequencing errors, users need to specify a sequencer to
the function <code><a href="../reference/simulate_seq.html">simulate_seq()</a></code>.</p>
<p>At the moment, there are only two classes implementing sequencers:
the <code>ErrorlessIlluminaSequencer</code> class and the
<code>BasicIlluminaSequencer</code> classes.</p>
<div class="section level4">
<h4 id="the-errorlessilluminasequencer-class">The <code>ErrorlessIlluminaSequencer</code> Class<a class="anchor" aria-label="anchor" href="#the-errorlessilluminasequencer-class"></a>
</h4>
<p>This class models a perfect Illumina sequencer. No sequencing errors
are produced, and all the bases have the maximum quality.</p>
<p>The following code simulates the sequencing by using this kind of
sequencer.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># build an error-less Illumina sequencer</span></span>
<span><span class="va">no_error_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ErrorlessIlluminaSequencer.html">ErrorlessIlluminaSequencer</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># let us simulate a 2.5x sequencing of the four sample</span></span>
<span><span class="co"># on the error-less sequencer</span></span>
<span><span class="va">seq_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_seq.html">simulate_seq</a></span><span class="op">(</span><span class="va">phylo_forest</span>, sequencer <span class="op">=</span> <span class="va">no_error_seq</span>,</span>
<span>                            coverage <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="the-basicilluminasequencer-class">The <code>BasicIlluminaSequencer</code> Class<a class="anchor" aria-label="anchor" href="#the-basicilluminasequencer-class"></a>
</h4>
<p>This class sets a sequencing error rate independent of the base in
which the error occurs, from the position of the base in the read and
from the position of the read on the genome.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># build a basic Illumina sequencer model in which errors occur</span></span>
<span><span class="co"># at rate 4e-3 per base</span></span>
<span><span class="va">basic_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/BasicIlluminaSequencer.html">BasicIlluminaSequencer</a></span><span class="op">(</span><span class="fl">4e-3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># let us simulate a 2.5x sequencing of the four sample</span></span>
<span><span class="co"># on the error-less sequencer</span></span>
<span><span class="va">seq_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_seq.html">simulate_seq</a></span><span class="op">(</span><span class="va">phylo_forest</span>, sequencer <span class="op">=</span> <span class="va">basic_seq</span>,</span>
<span>                            coverage <span class="op">=</span> <span class="fl">2.5</span>, write_SAM <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="chromosome-sequencing">Chromosome Sequencing<a class="anchor" aria-label="anchor" href="#chromosome-sequencing"></a>
</h3>
<p>The function <code><a href="../reference/simulate_seq.html">simulate_seq()</a></code> allows users to simulate the
sequencing of a selection of the reference chromosomes by using the
parameter <code>chromosomes</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># let us simulate a 2.5x sequencing of the chromosomes 22 and</span></span>
<span><span class="co"># X of the four sample</span></span>
<span><span class="va">seq_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_seq.html">simulate_seq</a></span><span class="op">(</span><span class="va">phylo_forest</span>, chromosomes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"22"</span>, <span class="st">"X"</span><span class="op">)</span>,</span>
<span>                            coverage <span class="op">=</span> <span class="fl">2.5</span>, write_SAM <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="updating-the-sam-output-directory">Updating the SAM Output Directory<a class="anchor" aria-label="anchor" href="#updating-the-sam-output-directory"></a>
</h3>
<p>Users may want to simulate sequencing in multiple steps, for
instance, by splitting it by chromosome or reaching the aimed coverage
with different simulations. However, rRACES prevents successive writing
in the same directory by default. The Boolean parameter
<code>update_SAM</code> allows multiple writing in the same
directory.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the default SAM directory already exists</span></span>
<span><span class="va">sam_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">"rRACES_SAM/"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># since the default save directory already exists, any call to</span></span>
<span><span class="co"># `simulate_seq` throws an error</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>  <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/simulate_seq.html">simulate_seq</a></span><span class="op">(</span><span class="va">phylo_forest</span>, coverage <span class="op">=</span> <span class="fl">2.5</span>, write_SAM <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span>  error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;std::domain_error in eval(expr, envir): "rRACES_SAM" already exists&gt;</span></span>
<span></span>
<span><span class="co"># setting `update_SAM` to TRUE enables successive writing in</span></span>
<span><span class="co"># the output directory</span></span>
<span><span class="va">seq_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_seq.html">simulate_seq</a></span><span class="op">(</span><span class="va">phylo_forest</span>, coverage <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>                            write_SAM <span class="op">=</span> <span class="cn">TRUE</span>, update_SAM <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [█---------------------------------------] 0% [00m:00s] Found 22 [█---------------------------------------] 0% [00m:00s] Reading 22 [█---------------------------------------] 0% [00m:01s] Reading 22 [█---------------------------------------] 0% [00m:02s] Reading 22 [█---------------------------------------] 0% [00m:02s] Processing chr. 22 [█---------------------------------------] 0% [00m:08s] Processing chr. 22 [██--------------------------------------] 3% [00m:09s] Processing chr. 22 [███-------------------------------------] 5% [00m:10s] Processing chr. 22 [████------------------------------------] 8% [00m:11s] Processing chr. 22 [█████-----------------------------------] 11% [00m:12s] Processing chr. 22 [██████----------------------------------] 14% [00m:13s] Processing chr. 22 [███████---------------------------------] 17% [00m:14s] Processing chr. 22 [█████████-------------------------------] 20% [00m:15s] Processing chr. 22 [██████████------------------------------] 23% [00m:16s] Processing chr. 22 [███████████-----------------------------] 26% [00m:17s] Processing chr. 22 [████████████----------------------------] 29% [00m:18s] Processing chr. 22 [█████████████---------------------------] 32% [00m:19s] Processing chr. 22 [███████████████-------------------------] 35% [00m:20s] Processing chr. 22 [████████████████------------------------] 38% [00m:21s] Processing chr. 22 [█████████████████-----------------------] 41% [00m:22s] Processing chr. 22 [██████████████████----------------------] 44% [00m:23s] Processing chr. 22 [███████████████████---------------------] 47% [00m:24s] Processing chr. 22 [████████████████████--------------------] 49% [00m:25s] Processing chr. 22 [█████████████████████-------------------] 51% [00m:26s] Processing chr. 22 [█████████████████████-------------------] 52% [00m:27s] Processing chr. 22 [██████████████████████------------------] 54% [00m:28s] Processing chr. 22 [███████████████████████-----------------] 56% [00m:29s] Processing chr. 22 [████████████████████████----------------] 58% [00m:30s] Processing chr. 22 [█████████████████████████---------------] 60% [00m:31s] Processing chr. 22 [█████████████████████████---------------] 62% [00m:32s] Processing chr. 22 [██████████████████████████--------------] 64% [00m:33s] Processing chr. 22 [███████████████████████████-------------] 66% [00m:34s] Processing chr. 22 [████████████████████████████------------] 68% [00m:35s] Processing chr. 22 [█████████████████████████████-----------] 70% [00m:36s] Processing chr. 22 [█████████████████████████████-----------] 72% [00m:37s] Processing chr. 22 [██████████████████████████████----------] 74% [00m:38s] Processing chr. 22 [███████████████████████████████---------] 76% [00m:39s] Processing chr. 22 [███████████████████████████████---------] 77% [00m:40s] Processing chr. 22 [████████████████████████████████--------] 78% [00m:41s] Processing chr. 22 [████████████████████████████████--------] 79% [00m:42s] Processing chr. 22 [████████████████████████████████--------] 79% [00m:43s] Processing chr. 22 [█████████████████████████████████-------] 80% [00m:44s] Processing chr. 22 [█████████████████████████████████-------] 80% [00m:45s] Processing chr. 22 [█████████████████████████████████-------] 81% [00m:46s] Processing chr. 22 [█████████████████████████████████-------] 81% [00m:47s] Processing chr. 22 [█████████████████████████████████-------] 82% [00m:48s] Processing chr. 22 [█████████████████████████████████-------] 82% [00m:49s] Processing chr. 22 [██████████████████████████████████------] 83% [00m:50s] Processing chr. 22 [██████████████████████████████████------] 84% [00m:51s] Processing chr. 22 [███████████████████████████████████-----] 85% [00m:52s] Processing chr. 22 [███████████████████████████████████-----] 85% [00m:53s] Processing chr. 22 [███████████████████████████████████-----] 86% [00m:54s] Processing chr. 22 [███████████████████████████████████-----] 87% [00m:55s] Processing chr. 22 [███████████████████████████████████-----] 87% [00m:56s] Processing chr. 22 [████████████████████████████████████----] 88% [00m:57s] Processing chr. 22 [████████████████████████████████████----] 88% [00m:58s] Processing chr. 22 [████████████████████████████████████----] 89% [00m:59s] Processing chr. 22 [█████████████████████████████████████---] 90% [01m:00s] Processing chr. 22 [█████████████████████████████████████---] 90% [01m:01s] Processing chr. 22 [█████████████████████████████████████---] 91% [01m:02s] Processing chr. 22 [█████████████████████████████████████---] 92% [01m:03s] Processing chr. 22 [██████████████████████████████████████--] 93% [01m:04s] Processing chr. 22 [██████████████████████████████████████--] 93% [01m:05s] Processing chr. 22 [██████████████████████████████████████--] 94% [01m:06s] Processing chr. 22 [███████████████████████████████████████-] 95% [01m:07s] Processing chr. 22 [███████████████████████████████████████-] 95% [01m:08s] Processing chr. 22 [███████████████████████████████████████-] 96% [01m:09s] Processing chr. 22 [███████████████████████████████████████-] 97% [01m:10s] Processing chr. 22 [███████████████████████████████████████-] 97% [01m:11s] Processing chr. 22 [████████████████████████████████████████] 98% [01m:12s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:13s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:14s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:15s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:16s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:17s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:18s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:19s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:20s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:21s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:22s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:23s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:24s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:25s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:26s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:27s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:28s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:29s] Processing chr. 22 [████████████████████████████████████████] 99% [01m:30s] Processing chr. 22 [████████████████████████████████████████] 100% [01m:34s] Reads simulated</span></span></code></pre></div>
<p>When the output directory already contains a SAM file associated with
a chromosome, the alignments on that chromosome are saved in a file
whose name is the first available, having the format
<code>"chr_{chromosome name}_{natural number}.sam"</code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">"rRACES_SAM/"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "chr_22_0.sam" "chr_22.sam"</span></span></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-10.1093/bioinformatics/btp352" class="csl-entry">
Li, Heng, Bob Handsaker, Alec Wysoker, Tim Fennell, Jue Ruan, Nils
Homer, Gabor Marth, Goncalo Abecasis, Richard Durbin, and 1000 Genome
Project Data Processing Subgroup. 2009. <span>“<span class="nocase">The
Sequence Alignment/Map format and SAMtools</span>.”</span>
<em>Bioinformatics</em> 25 (16): 2078–79. <a href="https://doi.org/10.1093/bioinformatics/btp352" class="external-link">https://doi.org/10.1093/bioinformatics/btp352</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alberto Casagrande, Giulio Caravagna.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
